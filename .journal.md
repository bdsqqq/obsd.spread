# obsd.spread journal

goal: render text file previews in obsidian bases card view (currently only images work as covers)

## thread chain
- root coordinator: T-019bc781-7a37-71b9-9965-20cc76456eab
- reference: obsd.any plugin (../obsd.any)
  - spawn tree root: T-019b993a (obsidian plugin, ~47 threads)
  - key threads: T-019b99e7 (CI/CD), T-019b9a9b (review rounds)

## status
- [x] step 1: scaffold plugin
- [x] step 2: research (bases api, obsidian docs, existing plugins)
- [x] step 3: plan implementation
- [x] step 4: execute (SpreadView implemented)
- [ ] step 5: test
- [ ] step 6: review
- [ ] step 7: iterate

## testing checklist
1. symlink plugin to obsidian vault: `ln -s /path/to/obsd.spread ~/.obsidian/plugins/dot-spread`
2. enable plugin in obsidian settings
3. create a base with some markdown files
4. in Configure View menu, select "Spread"
5. verify:
   - [ ] cards show text preview
   - [ ] file names are clickable
   - [ ] frontmatter stripped
   - [ ] config options work (lines, mono, etc.)
   - [ ] binary files show placeholder

## key research findings

**registerBasesView() is the answer** — obsidian exposes api for custom bases views.

### prior art: notebook navigator
- 35k LOC react app, replaces entire file explorer
- 1-5 preview lines, HTML stripping, thumbnails
- **bloat factor**: does everything, replaces core obsidian
- **1D only**: vertical list, no grid layout
- **our advantage**: 2D grid in bases, <500 LOC, extends not replaces

from .research-bases.md:
- `this.registerBasesView(ViewType, { factory, options })` — register custom view
- `BasesView` class with `onDataUpdated()` hook for data changes
- `entry.getValue(propertyName)` for property access
- grid-card-view plugin demonstrates the pattern

from .research-view-plugins.md:
- `registerMarkdownPostProcessor` for reading view content
- `registerMarkdownCodeBlockProcessor` for custom code blocks
- MutationObserver patterns (disconnect in onunload!)
- dataview, datacards, image-captions as reference implementations

**limitations discovered:**
- cards use ABSOLUTE positioning (no flex/grid css)
- no iframe support (confirmed by Licat)
- live preview requires codemirror extensions (defer for v1)

## decisions
- following obsd.any structure (src/main.ts, src/settings.ts, src/types.ts)
- using same build toolchain (esbuild, eslint-plugin-obsidianmd)
- **approach: create custom BasesView** via registerBasesView()
- defer live preview support

## open questions
- ~~how does bases render card covers?~~ ANSWERED: registerBasesView api
- ~~can we hook into the card rendering pipeline?~~ ANSWERED: yes, via BasesView.onDataUpdated()
- what's the text truncation/preview strategy? (first N chars? first paragraph?)
